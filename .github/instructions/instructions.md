---
applyTo: '**'
---
# AIコーディングエージェント ガイド（共通）
対象: Docusaurus v3 の日本語教材サイト（docs/ 配下）。複数コースに共通の運用ルール。

## ルール更新の運用方針
新たな要件・方針・指示が出た場合は、必ずこのルールファイルも同時に更新すること。教材や既存ドキュメントを読んで運用上の改善点や欠落を見つけた場合は「指示を待たずに」自発的にこのルールファイルへ反映すること。ルールと教材の整合性を継続的に保つ。その際ルールは短く簡潔に保つために、既存のルールを統合・削除・修正してもよい。

## 基本原則（本文・サンプル）
- **本文・ラベルはすべて日本語で記述**。説明・ラベル・出力文は学習者が理解できる日本語を使う。
- **学習済みの概念のみを前提に段階的に導入**。`sidebars.ts` の順序に基づき、未説明の概念や API は使用しない。資料を追加する際は、既に資料に記載のある内容のみ既知とし、それ以外は未習得とみなして記述・出題・解説を行うこと。
- **識別子は基本やさしい命名**。クラス名・変数名・id は短く分かりやすく（例: box, btn1, fruits）。初心者でも意図が推測できる語を選ぶ。発展では短い英単語も可（例: card, price）。
  - 原則として1文字の変数名は避ける（`a`, `b` 等）。例外: ループカウンタ（`i`, `j`）のみ許可。
- **1 サンプル = 1 トピック**。短く（目安 10 行以内）。学習トピックと無関係な要素を含めず、そのトピックにのみフォーカスした単純なサンプルを見せること。本質的に同じサンプルを複数入れず、異なる観点や用途を示すこと。コメントと空行で読みやすく。
- **コード例には必ずコメントと空行を入れ、読みやすさを最優先**。1つの処理ごとに空行で区切り、何の操作か・何が出力されるかを初学者が理解できるよう日本語コメントを添える。
- **出力箇所には常に期待値をコメント記載**。`console.log` など出力コマンドがある場合、その直後に `// 出力: ` で期待される出力内容を記載（例: `console.log(arr); // 出力: ["りんご","みかん"]`）。

## 学習者向け本文に入れてはいけない表現（必須）
教材の本文（学習者が読むコンテンツ）には、編集者向けの内部方針や判断基準を示す文言を入れないこと。具体例：「戻り値は扱わない」「ここでは詳細は教えない」といった学習範囲の除外を直接示す文言、「編集メモ: テンプレートリテラルは禁止」など編集者向けの注意書き、AI の思考プロセスやメタ的内容（例：「AIが考える...」「指示に基づいて...」）は本文に含めないこと。

## 学習導入での事例紹介（モチベーション喚起）
各学習テーマのまとまり（例: 配列メソッドの章、CSSの基礎パート）ごとに、章冒頭に1回だけ「今日の学習はこんなところで使うよ」という短い実用例を入れて、学習者の動機付けを行うこと。1〜2文の簡潔な説明で十分。可能なら「どのウェブサイトのどの部分で使うか」を具体的に示す（例: オンラインストアのカートで商品を追加/削除する場面）。実際のサイトを示す場合は、教育的で公共にアクセス可能なサイト（例: 教材サイト、W3Schoolsなど）を優先。個人情報が表示されるページや認証を必要とするページへはリンクしないこと。また可能なら、その実例を実際に CodePreview で再現してみせる。(ソースコードのvisibleはfalseとし、プレビューや必要に応じてコンソールのみ表示)

## 文法・記法の一貫性（必須）
- JavaScript では行末にセミコロン `;` を必ずつける。
- **JavaScript のコードには各処理行にコメントを入れる**。学習者が処理の流れを理解できるよう、1つ1つの処理が何をしているかを日本語コメントで説明する。
- コードブロックには必ず言語指定を行う（例: ````js`）。

## 主要ディレクトリとページ追加
- 主要: `docs/` 教材, `static/img/` 画像, `sidebars.ts` 並び順, `docusaurus.config.ts` 設定。
- 新規ページは `docs/<category>/x.md(x)` に作成し、`sidebar_position` を設定。必要なコンポーネントは先頭で import。

## CodePreview（@kodai-yamamoto-siw/code-preview）
- **ソースコードを見せる際は、基本的に CodePreview を使用**。ソースコードを示す場合は CodePreview を優先。明らかに CodePreview の機能が不要な場合（単純な構文説明、非実行コードなど）のみ通常のコードブロックを使用。
- `initialHTML` は body 内のみ、`initialCSS` は別。複数行は2行目以降2スペース字下げ。CSS の `{}` は前後を改行。
- 画像の相対参照は `images` マップで仮想→実パスを渡す。
- `sourceId` で複数プレビュー間の initialHTML/initialCSS 共有可（演習と解答で同じコードを共有したい場合）。
- 表示制御: `htmlVisible`, `cssVisible`, `jsVisible`, `previewVisible` で各パネルを切替。

例（MDX）:
```jsx
import { CodePreview } from '@kodai-yamamoto-siw/code-preview';
<CodePreview
  initialHTML={`<div class="box">A</div>
  <div class="box">B</div>`}
  initialCSS={`.box {
    padding: 8px;
    margin: 6px 0;
  }
  .box:nth-child(1) {
    background:#ffdddd;
  }`}
/>
```

## 演習（@kodai-yamamoto-siw/exercise）
- `@kodai-yamamoto-siw/exercise/client` の `<Exercise>` と `<Solution>` を使用。`<Solution>` は必ず同一 `<Exercise>` の末尾に配置。
- タイトル採番: `演習N`、発展は `演習N-発展`。ページ内で重複や飛び番を作らない。
- 問題は曖昧さを避け、開始データ・手順・確認方法・完成イメージを明示。問題文は簡潔に。解答コードは Solution 内に置き、説明は初学者向けに短く具体的に。
- **見た目を作成する演習では、完成イメージを視覚的に提示**。学習者が何を作るべきか最も理解しやすい方法を選択すること（プレビュー表示、提示コード内へのコメント指示など）。

### 演習・演習-発展の配置方針
- 各トピックごとに必ず「演習」と「演習-発展」をこまめに配置し、学習直後に実践できるようにすること。(資料末尾にまとめて配置しない)
- 「演習」は初学者が最低限知っておくべき内容までを目安とし、必要に応じて複数配置してよい。
- 「演習-発展」はより高いレベルの内容とし、全体を通して後半ほど難易度を上げること。発展問題は複数配置してもよい。
- 本質的に同じ内容の演習を繰り返さず、多角的な出題を心がけること。

### 演習問題の内容方針
- **演習**: 学習トピックと無関係な要素を含めず、そのトピックの習得にのみフォーカスした問題とすること。関係のない不要な要素を問題文に含めない。
- **演習-発展**: より実践的な問題としてもよいが、学習トピックを中心に習得できる問題とすること。

### 演習作成時の既習事項確認と重複回避（必須）
演習・演習-発展を作成する際は、必ず以下の手順を踏むこと：
1. **既習事項の確認**: `sidebars.ts` の順序に基づき、現在のページより前に配置されている内容のみを既習とみなす。現在のページ内で既に説明済みの内容も既習に含める。未習の API や構文等はすべて使用禁止。
2. **既出演習内容の確認**: 同一ページ内および過去のページで既に出題された演習内容をすべて確認する。「表面的な違い」ではなく「本質的な違い（学習ポイント・解法パターンの違い）」があるかを判断する。
3. **本質的重複の判定基準**: 同じイベント・同じ操作パターン・同じ学習ポイントの組み合わせは「本質的に同じ」とみなす。既出演習と異なる観点（状態管理、複数イベント組み合わせ、条件分岐、累積的変化、複数要素の連動）を持つ問題を作成すること。
4. **解法の実現可能性確認**: 作成した問題が、既習事項のみで解けることを確認する。未習事項を使わないと解けない場合や、コードの冗長な繰り返しだけになる場合は、別の観点で問題を再設計する。

例（MDX）:
```mdx
import Exercise, { Solution } from '@kodai-yamamoto-siw/exercise/client';
<Exercise title="演習1（3つの箱を縦に並べる）">
  要件: 幅200pxの箱を3つ、上下8px間隔で縦に配置。1つ目のみ薄い赤。
  <Solution>
    ```html
    <div class="box">A</div><div class="box">B</div><div class="box">C</div>
    ```
    ```css
    .box{width:200px;margin:8px 0;border:1px solid #ccc}.box:nth-child(1){background:#ffdddd}
    ```
  </Solution>
</Exercise>
```

## 画像
- 画像は `static/img/`。MDX からは各プロジェクトの baseUrl に従い `/.../img/ファイル名` で参照。
- CodePreview でローカル画像を使う場合は `images` で仮想パスを提供。
